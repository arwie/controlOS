' Copyright (c) 2016 Artur Wiebe <artur@4wiebe.de>
'
' Permission is hereby granted, free of charge, to any person obtaining a copy of this software and
' associated documentation files (the "Software"), to deal in the Software without restriction,
' including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,
' and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so,
' subject to the following conditions:
'
' The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
'
' THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
' INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
' IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
' WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
' OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


common shared prgPriorityHigh		as const long		= 8
common shared prgPriorityNormal		as const long		= 10
common shared prgPriorityLow		as const long		= 12

common shared errorApplication		as error	"error in application"		20810


IMPORT_C SHELL(byval as string) as string



public function sh(byval cmd_ as string) as string
	sh = SHELL(cmd_)
end function


public function max(byval a as double, byval b as double) as double
  if a > b then
    max = a
  else
    max = b
  end if
end function

public function maxl(byval a as long, byval b as long) as long
  if a > b then
    maxl = a
  else
    maxl = b
  end if
end function


public function min(byval a as double, byval b as double) as double
  if a < b then
    min = a
  else
    min = b
  end if
end function

public function minl(byval a as long, byval b as long) as long
  if a < b then
    minl = a
  else
    minl = b
  end if
end function



public function sinDeg(byval angle_ as double) as double
	sinDeg = sin(angle_*PI/180)
end function

public function cosDeg(byval angle_ as double) as double
	cosDeg = cos(angle_*PI/180)
end function


public function normDeg(byval angle_ as double) as double
	normDeg = angle_ mod 360
	if abs(normDeg) > 180 then
		normDeg = normDeg - sgn(normDeg)*360
	end if
end function



public function taskIsRunning(byval task_ as string) as long
	try
		taskIsRunning = (taskstate(task_) <> TASK_KILLED)
	catch else
		taskIsRunning = false
	end try
end function


public sub taskKillUnload(byval task_ as string)
	try 
		killtask$ task_
	catch else
	end try
	try 
		unload$ task_
	catch else
	end try
end sub
